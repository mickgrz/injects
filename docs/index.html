<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="v1.0.0, April 3, 2017">
<title>injects</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./pygments-default.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>injects</h1>
<div class="details">
<span id="author" class="author">v1.0.0, April 3, 2017</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Dependency Injection for TypeScript</div>
<ul class="sectlevel1">
<li><a href="#_use_case">Use case</a>
<ul class="sectlevel2">
<li><a href="#_example">Example</a></li>
<li><a href="#_unit_test_example">Unit test example</a></li>
</ul>
</li>
<li><a href="#_installation">Installation</a></li>
<li><a href="#_technical_documentation">Technical documentation</a>
<ul class="sectlevel2">
<li><a href="#_api">Api</a>
<ul class="sectlevel3">
<li><a href="#_inject">inject</a></li>
<li><a href="#_injectable">Injectable</a></li>
<li><a href="#_injectables">injectables</a></li>
<li><a href="#_exists">exists</a></li>
<li><a href="#_resetinjectables">resetInjectables</a></li>
<li><a href="#_resetinjectable">resetInjectable</a></li>
</ul>
</li>
<li><a href="#_lint">Lint</a></li>
<li><a href="#_packaging">Packaging</a></li>
<li><a href="#_documentation">Documentation</a>
<ul class="sectlevel3">
<li><a href="#_typescript_documentation_is_available_a_href_typedoc_index_html_target_blank_here_a">Typescript documentation is available <a href="typedoc/index.html" target="_blank">here</a></a></li>
</ul>
</li>
<li><a href="#_tests">Tests</a>
<ul class="sectlevel3">
<li><a href="#_execution_report_is_available_a_href_test_index_html_target_blank_here_a">Execution report is available <a href="test/index.html" target="_blank">here</a></a></li>
<li><a href="#_coverage_report_is_available_a_href_test_coverage_index_html_target_blank_here_a">Coverage report is available <a href="test/coverage/index.html" target="_blank">here</a></a></li>
<li><a href="#_unit_tests">Unit tests</a>
<ul class="sectlevel4">
<li><a href="#_should_register_dependency">should register dependency</a></li>
<li><a href="#_should_inject_dependency">should inject dependency</a></li>
<li><a href="#_should_inject_class_dependency">should inject class dependency</a></li>
<li><a href="#_should_inject_custom_object_instance">should inject custom object instance</a></li>
<li><a href="#_should_inject_custom_class_instance">should inject custom class instance</a></li>
<li><a href="#_should_throw_assert_exception_when_creating_injectable_with_custom_string_key_but_without_instance">should throw assert exception when creating injectable with custom string key but without instance</a></li>
<li><a href="#_should_inject_string">should inject string</a></li>
<li><a href="#_should_inject_number">should inject number</a></li>
<li><a href="#_should_register_injectable">should register @Injectable</a></li>
<li><a href="#_should_inject_in_cascade">should inject in cascade</a></li>
<li><a href="#_should_reset_injectables">should reset injectables</a></li>
<li><a href="#_should_reset_injectable">should reset injectable</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_development">Development</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_npm_scripts">Npm scripts</a></li>
<li><a href="#_files">Files</a>
<ul class="sectlevel4">
<li><a href="#package.json">package.json</a></li>
<li><a href="#injects.ts">injects.ts</a></li>
<li><a href="#tslint.json">tslint.json</a></li>
<li><a href="#injects.spec.ts">injects.spec.ts</a></li>
<li><a href="#nycrc">.nycrc</a></li>
<li><a href="#webpack.config.js">webpack.config.js</a></li>
<li><a href="#tsconfig.json">tsconfig.json</a></li>
<li><a href="#editorconfig">.editorconfig</a></li>
<li><a href="#gitignore">.gitignore</a></li>
<li><a href="#readme.md">readme.md</a></li>
<li><a href="#index.adoc">index.adoc</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://mickgrz.github.io/injects/" class="bare">https://mickgrz.github.io/injects/</a></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Dependency Injection for TypeScript</div>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case">Use case</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use a class instance without instantiate it.</p>
</div>
<div class="paragraph">
<p>The responsibility of providing dependency is delegated to an injector.</p>
</div>
<div class="paragraph">
<p>This separates the responsibilities of usages and construction.</p>
</div>
<div class="paragraph">
<p>This also improves readability, testability &amp; maintainability.</p>
</div>
<div class="sect2">
<h3 id="_example">Example</h3>
<div class="listingblock">
<div class="title">Dao.ts</div>
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-kr">class</span> <span class="tok-nx">Dao</span> <span class="tok-p">{</span>
    <span class="tok-kr">public</span> <span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-nx">entity</span>: <span class="tok-kt">any</span><span class="tok-p">)</span> <span class="tok-p">{</span>
        <span class="tok-p">[...]</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="title">Service.ts</div>
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-kr">import</span> <span class="tok-p">{</span><span class="tok-nx">inject</span><span class="tok-p">}</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;injects&#39;</span><span class="tok-p">;</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-kr">import</span> <span class="tok-nx">Dao</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;./Dao&#39;</span><span class="tok-p">;</span>

<span class="tok-kr">class</span> <span class="tok-nx">Service</span> <span class="tok-p">{</span>

  <span class="tok-kr">private</span> <span class="tok-nx">dao</span>: <span class="tok-kt">Dao</span><span class="tok-p">;</span>

  <span class="tok-kr">constructor</span><span class="tok-p">()</span> <span class="tok-p">{</span>
    <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">dao</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Dao</span><span class="tok-p">);</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="tok-p">}</span>

  <span class="tok-kr">public</span> <span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-nx">entity</span>: <span class="tok-kt">any</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">dao</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-nx">entity</span><span class="tok-p">);</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>imports inject function</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>inject instance of Dao class</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-kr">const</span> <span class="tok-nx">service</span>: <span class="tok-kt">Service</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nx">Service</span><span class="tok-p">();</span>
<span class="tok-nx">service</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">({</span> <span class="tok-nx">entityId</span>: <span class="tok-kt">1</span> <span class="tok-p">});</span><span class="tok-c1">// will call dao.create</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also write :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-kr">import</span> <span class="tok-p">{</span><span class="tok-nx">inject</span><span class="tok-p">}</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;injects&#39;</span><span class="tok-p">;</span>
<span class="tok-kr">import</span> <span class="tok-nx">Dao</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;./Dao&#39;</span><span class="tok-p">;</span>

<span class="tok-kr">class</span> <span class="tok-nx">Service</span> <span class="tok-p">{</span>

  <span class="tok-kr">private</span> <span class="tok-nx">dao</span>: <span class="tok-kt">Dao</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Dao</span><span class="tok-p">);</span>

  <span class="tok-kr">public</span> <span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-nx">entity</span>: <span class="tok-kt">any</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">dao</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-nx">entity</span><span class="tok-p">);</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unit_test_example">Unit test example</h3>
<div class="paragraph">
<p>Stubbing dependency is easy :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-kr">import</span> <span class="tok-p">{</span><span class="tok-nx">Injectable</span><span class="tok-p">}</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;injects&#39;</span><span class="tok-p">;</span>
<span class="tok-kr">import</span> <span class="tok-o">*</span> <span class="tok-kr">as</span> <span class="tok-nx">sinon</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;sinon&#39;</span><span class="tok-p">;</span>

<span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;Dao&#39;</span><span class="tok-p">,</span> <span class="tok-nx">sinon</span><span class="tok-p">.</span><span class="tok-nx">stub</span><span class="tok-p">());</span>
<span class="tok-kr">const</span> <span class="tok-nx">service</span>: <span class="tok-kt">Service</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nx">Service</span><span class="tok-p">();</span><span class="tok-c1">// will get stub dependency</span>
<span class="tok-nx">service</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">({</span> <span class="tok-nx">entityId</span>: <span class="tok-kt">1</span> <span class="tok-p">});</span><span class="tok-c1">// will call the stub</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Name of dependency&#8217;s class is the key used when to register the dependency instance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>npm install --save injects</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_technical_documentation">Technical documentation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_api">Api</h3>
<div class="sect3">
<h4 id="_inject">inject</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Inject unique instance associated with class name or with custom string key.</span>
<span class="tok-cm"> * Create unique class instance if it doesn&#39;t exist.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param constructorOrKey class constructor or custom string key</span>
<span class="tok-cm"> * @return the unique instance associated with class name or with custom string key</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">constructorOrKey</span>: <span class="tok-kt">Function</span> <span class="tok-o">|</span> <span class="tok-kt">string</span><span class="tok-p">)</span><span class="tok-o">:</span> <span class="tok-nx">any</span> <span class="tok-p">{</span>
  <span class="tok-kd">let</span> <span class="tok-nx">key</span>: <span class="tok-kt">string</span><span class="tok-p">;</span>
  <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">constructorOrKey</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
    <span class="tok-kr">const</span> <span class="tok-kr">constructor</span><span class="tok-o">:</span> <span class="tok-nb">Function</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">name</span><span class="tok-p">;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-nx">key</span><span class="tok-p">))</span> <span class="tok-p">{</span>
      <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-kr">constructor</span><span class="tok-p">);</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tok-p">}</span>
  <span class="tok-p">}</span>
  <span class="tok-k">return</span> <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">key</span><span class="tok-p">];</span> <i class="conum" data-value="4"></i><b>(4)</b>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>parameter is used as key</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>class name is used as key</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>register new injectable class instance if it doesn&#8217;t exist</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>return injectable indexed by key</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_injectable">Injectable</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Register an injectable.</span>
<span class="tok-cm"> * Can be used as a class decorator or as a function.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param constructorOrKey class constructor or custom string key</span>
<span class="tok-cm"> * @param instance custom instance to register (optional with class constructor, mandatory with string key)</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">constructorOrKey</span>: <span class="tok-kt">Function</span> <span class="tok-o">|</span> <span class="tok-kt">string</span><span class="tok-p">,</span> <span class="tok-nx">instance?</span>: <span class="tok-kt">any</span><span class="tok-p">)</span><span class="tok-o">:</span> <span class="tok-k">void</span> <span class="tok-p">{</span>
  <span class="tok-kd">let</span> <span class="tok-nx">key</span>: <span class="tok-kt">string</span><span class="tok-p">,</span> <span class="tok-nx">injectable</span>: <span class="tok-kt">any</span><span class="tok-p">;</span>
  <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">constructorOrKey</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">assert</span><span class="tok-p">.</span><span class="tok-nx">equal</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-o">!!</span><span class="tok-p">(</span><span class="tok-nx">instance</span><span class="tok-p">),</span> <span class="tok-s1">&#39;can\&#39;t define injectable without instance&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">injectable</span> <span class="tok-o">=</span> <span class="tok-nx">instance</span>
  <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
    <span class="tok-kr">const</span> <span class="tok-kr">constructor</span><span class="tok-o">:</span> <span class="tok-nb">Function</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">name</span><span class="tok-p">;</span>
    <span class="tok-nx">injectable</span> <span class="tok-o">=</span> <span class="tok-nx">instance</span> <span class="tok-o">?</span> <span class="tok-nx">instance</span> : <span class="tok-kt">new</span> <span class="tok-p">(</span><span class="tok-nb">Object</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">prototype</span><span class="tok-p">)).</span><span class="tok-kr">constructor</span><span class="tok-p">();</span>
  <span class="tok-p">}</span>
  <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">key</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-nx">injectable</span><span class="tok-p">;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_injectables">injectables</h4>
<div class="paragraph">
<p>An in-memory registry (a map string:any) is used to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * All injectables.</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">let</span> <span class="tok-nx">injectables</span><span class="tok-o">:</span> <span class="tok-p">{</span> <span class="tok-p">[</span><span class="tok-nx">k</span>: <span class="tok-kt">string</span><span class="tok-p">]</span><span class="tok-o">:</span> <span class="tok-nx">any</span><span class="tok-p">;</span> <span class="tok-p">}</span> <span class="tok-o">=</span> <span class="tok-p">{};</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exists">exists</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * In order to know if a dependency exists or not.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param name dependency name</span>
<span class="tok-cm"> * @returns true if dependency exist, false otherwise</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-nx">name</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-k">return</span> <span class="tok-nb">Object</span><span class="tok-p">.</span><span class="tok-nx">keys</span><span class="tok-p">(</span><span class="tok-nx">injectables</span><span class="tok-p">).</span><span class="tok-nx">some</span><span class="tok-p">(</span><span class="tok-nx">k</span> <span class="tok-o">=&gt;</span> <span class="tok-nx">k</span> <span class="tok-o">===</span> <span class="tok-nx">name</span><span class="tok-p">);</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_resetinjectables">resetInjectables</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Only for tests : delete all injectables</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">resetInjectables() {</span>
  <span class="tok-nx">injectables</span> <span class="tok-o">=</span> <span class="tok-p">{};</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_resetinjectable">resetInjectable</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Only for tests : delete an injectable</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">resetInjectable</span><span class="tok-p">(</span><span class="tok-nx">name</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-k">delete</span> <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">name</span><span class="tok-p">];</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#injects.ts">injects.ts</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lint">Lint</h3>
<div class="paragraph">
<p>Code is lint with <a href="https://github.com/palantir/tslint" target="_blank">tslint</a>. See <a href="#tslint.json">tslint.json</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run lint</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_packaging">Packaging</h3>
<div class="paragraph">
<p>Bundle is generated with <a href="https://github.com/webpack/webpack" target="_blank">webpack</a>. See <a href="#webpack.config.js">webpack.config.js</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run build:bundle</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="paragraph">
<p>This technical documentation is generated with <a href="https://github.com/asciidoctor" target="_blank">asciidoctor</a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run build:doc:living</pre>
</div>
</div>
<div class="sect3">
<h4 id="_typescript_documentation_is_available_a_href_typedoc_index_html_target_blank_here_a">Typescript documentation is available <a href="typedoc/index.html" target="_blank">here</a></h4>
<div class="paragraph">
<p>It&#8217;s generated with <a href="https://github.com/TypeStrong/typedoc" target="_blank">typedoc</a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run build:doc:typedoc</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tests">Tests</h3>
<div class="paragraph">
<p>Tests run with <a href="https://github.com/mochajs/mocha" target="_blank">mocha</a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run test</pre>
</div>
</div>
<div class="paragraph">
<p>Assertions are wrote with <a href="https://github.com/chaijs/chai" target="_blank">chai</a>, using the <strong>expect syntax</strong>.</p>
</div>
<div class="paragraph">
<p>See <a href="#injects.spec.ts">injects.spec.ts</a></p>
</div>
<div class="sect3">
<h4 id="_execution_report_is_available_a_href_test_index_html_target_blank_here_a">Execution report is available <a href="test/index.html" target="_blank">here</a></h4>
<div class="paragraph">
<p>It&#8217;s generated with <a href="https://github.com/blond/mocha-simple-html-reporter" target="_blank">mocha-simple-html-reporter</a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run test:report</pre>
</div>
</div>
<html>
<head>
    <title>Mocha</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <style type="text/css">
    @charset "utf-8";

body {
  margin:0;
}

#mocha {
  font: 20px/1.5 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 60px 50px;
}

#mocha ul,
#mocha li {
  margin: 0;
  padding: 0;
}

#mocha ul {
  list-style: none;
}

#mocha h1,
#mocha h2 {
  margin: 0;
}

#mocha h1 {
  margin-top: 15px;
  font-size: 1em;
  font-weight: 200;
}

#mocha h1 a {
  text-decoration: none;
  color: inherit;
}

#mocha h1 a:hover {
  text-decoration: underline;
}

#mocha .suite .suite h1 {
  margin-top: 0;
  font-size: .8em;
}

#mocha .hidden {
  display: none;
}

#mocha h2 {
  font-size: 12px;
  font-weight: normal;
  cursor: pointer;
}

#mocha .suite {
  margin-left: 15px;
}

#mocha .test {
  margin-left: 15px;
  overflow: hidden;
}

#mocha .test.pending:hover h2::after {
  content: '(pending)';
  font-family: arial, sans-serif;
}

#mocha .test.pass.medium .duration {
  background: #c09853;
}

#mocha .test.pass.slow .duration {
  background: #b94a48;
}

#mocha .test.pass::before {
  content: '✓';
  font-size: 12px;
  display: block;
  float: left;
  margin-right: 5px;
  color: #00d6b2;
}

#mocha .test.pass .duration {
  font-size: 9px;
  margin-left: 5px;
  padding: 2px 5px;
  color: #fff;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.2);
  -moz-box-shadow: inset 0 1px 1px rgba(0,0,0,.2);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.2);
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  -ms-border-radius: 5px;
  -o-border-radius: 5px;
  border-radius: 5px;
}

#mocha .test.pass.fast .duration {
  display: none;
}

#mocha .test.pending {
  color: #0b97c4;
}

#mocha .test.pending::before {
  content: '◦';
  color: #0b97c4;
}

#mocha .test.fail {
  color: #c00;
}

#mocha .test.fail pre {
  color: black;
}

#mocha .test.fail::before {
  content: '✖';
  font-size: 12px;
  display: block;
  float: left;
  margin-right: 5px;
  color: #c00;
}

#mocha .test pre.error {
  color: #c00;
  max-height: 300px;
  overflow: auto;
}

#mocha .test .html-error {
  overflow: auto;
  color: black;
  line-height: 1.5;
  display: block;
  float: left;
  clear: left;
  font: 12px/1.5 monaco, monospace;
  margin: 5px;
  padding: 15px;
  border: 1px solid #eee;
  max-width: 85%; /*(1)*/
  max-width: -webkit-calc(100% - 42px);
  max-width: -moz-calc(100% - 42px);
  max-width: calc(100% - 42px); /*(2)*/
  max-height: 300px;
  word-wrap: break-word;
  border-bottom-color: #ddd;
  -webkit-box-shadow: 0 1px 3px #eee;
  -moz-box-shadow: 0 1px 3px #eee;
  box-shadow: 0 1px 3px #eee;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}

#mocha .test .html-error pre.error {
  border: none;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-box-shadow: 0;
  -moz-box-shadow: 0;
  box-shadow: 0;
  padding: 0;
  margin: 0;
  margin-top: 18px;
  max-height: none;
}

/**
 * (1): approximate for browsers not supporting calc
 * (2): 42 = 2*15 + 2*10 + 2*1 (padding + margin + border)
 *      ^^ seriously
 */
#mocha .test pre {
  display: block;
  float: left;
  clear: left;
  font: 12px/1.5 monaco, monospace;
  margin: 5px;
  padding: 15px;
  border: 1px solid #eee;
  max-width: 85%; /*(1)*/
  max-width: -webkit-calc(100% - 42px);
  max-width: -moz-calc(100% - 42px);
  max-width: calc(100% - 42px); /*(2)*/
  word-wrap: break-word;
  border-bottom-color: #ddd;
  -webkit-box-shadow: 0 1px 3px #eee;
  -moz-box-shadow: 0 1px 3px #eee;
  box-shadow: 0 1px 3px #eee;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}

#mocha .test h2 {
  position: relative;
}

#mocha .test a.replay {
  position: absolute;
  top: 3px;
  right: 0;
  text-decoration: none;
  vertical-align: middle;
  display: block;
  width: 15px;
  height: 15px;
  line-height: 15px;
  text-align: center;
  background: #eee;
  font-size: 15px;
  -webkit-border-radius: 15px;
  -moz-border-radius: 15px;
  border-radius: 15px;
  -webkit-transition:opacity 200ms;
  -moz-transition:opacity 200ms;
  -o-transition:opacity 200ms;
  transition: opacity 200ms;
  opacity: 0.3;
  color: #888;
}

#mocha .test:hover a.replay {
  opacity: 1;
}

#mocha-report.pass .test.fail {
  display: none;
}

#mocha-report.fail .test.pass {
  display: none;
}

#mocha-report.pending .test.pass,
#mocha-report.pending .test.fail {
  display: none;
}
#mocha-report.pending .test.pass.pending {
  display: block;
}

#mocha-error {
  color: #c00;
  font-size: 1.5em;
  font-weight: 100;
  letter-spacing: 1px;
}

#mocha-stats {
  position: fixed;
  top: 15px;
  right: 10px;
  font-size: 12px;
  margin: 0;
  color: #888;
  z-index: 1;
}

#mocha-stats .progress {
  float: right;
  padding-top: 0;

  /**
   * Set safe initial values, so mochas .progress does not inherit these
   * properties from Bootstrap .progress (which causes .progress height to
   * equal line height set in Bootstrap).
   */
  height: auto;
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none;
  background-color: initial;
}

#mocha-stats em {
  color: black;
}

#mocha-stats a {
  text-decoration: none;
  color: inherit;
}

#mocha-stats a:hover {
  border-bottom: 1px solid #eee;
}

#mocha-stats li {
  display: inline-block;
  margin: 0 5px;
  list-style: none;
  padding-top: 11px;
}

#mocha-stats canvas {
  width: 40px;
  height: 40px;
}

#mocha code .comment { color: #ddd; }
#mocha code .init { color: #2f6fad; }
#mocha code .string { color: #5890ad; }
#mocha code .keyword { color: #8a6343; }
#mocha code .number { color: #2f6fad; }

@media screen and (max-device-width: 480px) {
  #mocha {
    margin: 60px 0px;
  }

  #mocha #stats {
    position: absolute;
  }
}

    #mocha .test.pass pre {
        display: none;
    }
    #mocha .test:hover h2:after {
        color: #888888;
        content: "(view source)";
        font-family: arial;
        font-size: 12px;
        position: relative;
        right: -10px;
        top: 0;
    }
    </style>
</head>

<body>
    <div id="mocha">
        <ul id="stats">
            <li class="passes">passes: <em>12</em></li>
            <li class="failures">failures: <em>0</em></li>
            <li class="duration">duration: <em>26ms</em></li>
        </ul>
        <ul id="report"><li class="suite"><h1>Dependency Injection</h1><ul><li class="test pass fast"><h2>should register dependency<span class="duration">3ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        class Sample {
        }
        assume(injects_1.exists('Sample')).to.be.false;
        // When
        injects_1.Injectable(Sample);
        // Then
        chai_1.expect(injects_1.exists('Sample')).to.be.true;
    })</code></pre></li><li class="test pass fast"><h2>should inject dependency<span class="duration">1ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        class Sample {
        }
        assume(injects_1.exists('Sample')).to.be.false;
        injects_1.Injectable(Sample);
        assume(injects_1.exists('Sample')).to.be.true;
        // When
        const sample = injects_1.inject(Sample);
        // Then
        chai_1.expect(sample).to.be.an.instanceOf(Sample);
    })</code></pre></li><li class="test pass fast"><h2>should inject class dependency<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        class Sample {
        }
        assume(injects_1.exists('Sample')).to.be.false;
        // When
        const sample = injects_1.inject(Sample);
        // Then
        chai_1.expect(sample).to.not.be.null;
        true;
    })</code></pre></li><li class="test pass fast"><h2>should inject custom object instance<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('sample')).to.be.false;
        class Sample {
            constructor(value) {
                this.value = value;
            }
        }
        const sampleValue = 'testSampleValue';
        injects_1.Injectable('sample', new Sample(sampleValue));
        assume(injects_1.exists('sample')).to.be.true;
        // When
        const sample = injects_1.inject('sample');
        // Then
        chai_1.expect(sample.value).to.eql(sampleValue);
    })</code></pre></li><li class="test pass fast"><h2>should inject custom class instance<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('Sample')).to.be.false;
        class Sample {
            constructor(value) {
                this.value = value;
            }
        }
        const sampleValue = 'testSampleValue';
        injects_1.Injectable(Sample, new Sample(sampleValue));
        assume(injects_1.exists('Sample')).to.be.true;
        // When
        const sample = injects_1.inject(Sample);
        // Then
        chai_1.expect(sample.value).to.eql(sampleValue);
    })</code></pre></li><li class="test pass fast"><h2>should throw assert exception when creating Injectable with custom string key but without instance<span class="duration">14ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('sample')).to.be.false;
        let assertionError = false;
        try {
            // When
            injects_1.Injectable('sample');
        }
        catch (e) {
            assertionError = true;
        }
        // Then
        chai_1.expect(assertionError).to.be.true;
    })</code></pre></li><li class="test pass fast"><h2>should inject string<span class="duration">1ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('sample')).to.be.false;
        const sampleValue = 'testSample';
        injects_1.Injectable('sample', sampleValue);
        assume(injects_1.exists('sample')).to.be.true;
        // When
        const sample = injects_1.inject('sample');
        // Then
        chai_1.expect(sample).to.eql(sampleValue);
        chai_1.expect(sample).to.be.a('string');
    })</code></pre></li><li class="test pass fast"><h2>should inject number<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('sample')).to.be.false;
        const sampleValue = 1;
        injects_1.Injectable('sample', sampleValue);
        assume(injects_1.exists('sample')).to.be.true;
        // When
        const sample = injects_1.inject('sample');
        // Then
        chai_1.expect(sample).to.eql(sampleValue);
        chai_1.expect(sample).to.be.a('number');
    })</code></pre></li><li class="test pass fast"><h2>should register @Injectable<span class="duration">1ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('Sample')).to.be.false;
        // When
        let Sample = class Sample {
        };
        Sample = __decorate([
            injects_1.Injectable
        ], Sample);
        // Then
        chai_1.expect(injects_1.exists('Sample')).to.be.true;
    })</code></pre></li><li class="test pass fast"><h2>should inject in cascade<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        let One = class One {
        };
        One = __decorate([
            injects_1.Injectable
        ], One);
        let Two = class Two {
            constructor() { this.one = injects_1.inject(One); }
        };
        Two = __decorate([
            injects_1.Injectable
        ], Two);
        let Three = class Three {
            constructor() { this.two = injects_1.inject(Two); }
        };
        Three = __decorate([
            injects_1.Injectable
        ], Three);
        // When
        const three = injects_1.inject(Three);
        // Then
        chai_1.expect(three).to.be.an.instanceOf(Three);
        chai_1.expect(three.two).to.be.an.instanceOf(Two);
        chai_1.expect(three.two.one).to.be.an.instanceOf(One);
    })</code></pre></li><li class="test pass fast"><h2>should reset injectables<span class="duration">0ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('Sample')).to.be.false;
        assume(injects_1.exists('Sample')).to.be.false;
        class Sample {
        }
        class Sample2 {
        }
        injects_1.Injectable(Sample);
        injects_1.Injectable(Sample2);
        chai_1.expect(injects_1.exists('Sample')).to.be.true;
        chai_1.expect(injects_1.exists('Sample2')).to.be.true;
        // When
        injects_1.resetInjectables();
        // Then
        chai_1.expect(injects_1.exists('Sample')).to.be.false;
        chai_1.expect(injects_1.exists('Sample2')).to.be.false;
    })</code></pre></li><li class="test pass fast"><h2>should reset injectable<span class="duration">1ms</span></h2><pre><code>__awaiter(this, void 0, void 0, function* () {
        // Given
        assume(injects_1.exists('Sample')).to.be.false;
        assume(injects_1.exists('Sample')).to.be.false;
        class Sample {
        }
        class Sample2 {
        }
        injects_1.Injectable(Sample);
        injects_1.Injectable(Sample2);
        chai_1.expect(injects_1.exists('Sample')).to.be.true;
        chai_1.expect(injects_1.exists('Sample2')).to.be.true;
        // When
        injects_1.resetInjectable('Sample');
        // Then
        chai_1.expect(injects_1.exists('Sample')).to.be.false;
        chai_1.expect(injects_1.exists('Sample2')).to.be.true;
    })</code></pre></li></ul></li><ul>
    </div>
    <script>
        var tests = document.getElementsByClassName('test');

        for (var i = 0; i < tests.length; i++) {
            var elem = tests[i];

            if (elem.className.includes('pass')) {
                var head = elem.children[0];

                head.onclick = function () {
                    var code = this.parentElement.children[1];
                    var display = code.style.display;

                    if (display && display === 'block') {
                        code.style.display = 'none';
                    } else {
                        code.style.display = 'block';
                    }
                };
            }
        }
    </script>
</body>
</html>
</div>
<div class="sect3">
<h4 id="_coverage_report_is_available_a_href_test_coverage_index_html_target_blank_here_a">Coverage report is available <a href="test/coverage/index.html" target="_blank">here</a></h4>
<div class="paragraph">
<p>It&#8217;s generated with <a href="https://github.com/istanbuljs/nyc" target="_blank">nyc</a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>npm run test:report</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#nycrc">.nycrc</a> config file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unit_tests">Unit tests</h4>
<div class="sect4">
<h5 id="_should_register_dependency">should register dependency</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should register dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_dependency">should inject dependency</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_class_dependency">should inject class dependency</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject class dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">not</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">null</span><span class="tok-p">;</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_custom_object_instance">should inject custom object instance</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject custom object instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{</span> <span class="tok-kr">constructor</span><span class="tok-p">(</span><span class="tok-kr">public</span> <span class="tok-nx">value</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{}</span> <span class="tok-p">}</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSampleValue&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-k">new</span> <span class="tok-nx">Sample</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">));</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>:<span class="tok-kt">Sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">.</span><span class="tok-nx">value</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_custom_class_instance">should inject custom class instance</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject custom class instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{</span> <span class="tok-kr">constructor</span><span class="tok-p">(</span><span class="tok-kr">public</span> <span class="tok-nx">value</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{}</span> <span class="tok-p">}</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSampleValue&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">,</span> <span class="tok-k">new</span> <span class="tok-nx">Sample</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">));</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>:<span class="tok-kt">Sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">.</span><span class="tok-nx">value</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_throw_assert_exception_when_creating_injectable_with_custom_string_key_but_without_instance">should throw assert exception when creating injectable with custom string key but without instance</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should throw assert exception when creating Injectable with custom string key but without instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-kd">let</span> <span class="tok-nx">assertionError</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-k">try</span> <span class="tok-p">{</span>
      <span class="tok-c1">// When</span>
      <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>
    <span class="tok-p">}</span> <span class="tok-k">catch</span> <span class="tok-p">(</span><span class="tok-nx">e</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-nx">assertionError</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">assertionError</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_string">should inject string</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject string&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span>: <span class="tok-kt">string</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSample&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>: <span class="tok-kt">string</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">a</span><span class="tok-p">(</span><span class="tok-s1">&#39;string&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_number">should inject number</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject number&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span>: <span class="tok-kt">number</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>: <span class="tok-kt">number</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">a</span><span class="tok-p">(</span><span class="tok-s1">&#39;number&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_register_injectable">should register @Injectable</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should register @Injectable&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_inject_in_cascade">should inject in cascade</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject in cascade&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">One</span> <span class="tok-p">{}</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Two</span> <span class="tok-p">{</span> <span class="tok-kr">public</span> <span class="tok-nx">one</span>: <span class="tok-kt">One</span><span class="tok-p">;</span> <span class="tok-kr">constructor</span><span class="tok-p">()</span> <span class="tok-p">{</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">one</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">One</span><span class="tok-p">);</span> <span class="tok-p">}</span> <span class="tok-p">}</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Three</span> <span class="tok-p">{</span> <span class="tok-kr">public</span> <span class="tok-nx">two</span>: <span class="tok-kt">Two</span><span class="tok-p">;</span> <span class="tok-kr">constructor</span><span class="tok-p">()</span> <span class="tok-p">{</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">two</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Two</span><span class="tok-p">);</span> <span class="tok-p">}</span> <span class="tok-p">}</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">three</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Three</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Three</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">.</span><span class="tok-nx">two</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Two</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">.</span><span class="tok-nx">two</span><span class="tok-p">.</span><span class="tok-nx">one</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">One</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_reset_injectables">should reset injectables</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should reset injectables&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample2</span> <span class="tok-p">{}</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample2</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">resetInjectables</span><span class="tok-p">();</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_should_reset_injectable">should reset injectable</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span></span>  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should reset injectable&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample2</span> <span class="tok-p">{}</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample2</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">resetInjectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_development">Development</h3>
<div class="sect3">
<h4 id="_prerequisites">Prerequisites</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/asciidoctor" target="_blank">asciidoctor</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_npm_scripts">Npm scripts</h4>
<div class="ulist">
<ul>
<li>
<p><strong>clean</strong> : remove build/ directory with <a href="https://github.com/isaacs/rimraf" target="_blank">rimraf</a></p>
</li>
<li>
<p><strong>lint</strong> : lint source directory with <a href="https://github.com/palantir/tslint" target="_blank">tslint</a>. See <a href="#tslint.json">tslint.json</a></p>
</li>
<li>
<p><strong>test</strong> : run tests with <a href="https://github.com/mochajs/mocha" target="_blank">mocha</a> &amp; <a href="https://github.com/chaijs/chai" target="_blank">chai</a></p>
</li>
<li>
<p><strong>test:report</strong> : run tests with <a href="https://github.com/istanbuljs/nyc" target="_blank">nyc</a> over <a href="https://github.com/mochajs/mocha" target="_blank">mocha</a> with <a href="https://github.com/blond/mocha-simple-html-reporter" target="_blank">mocha-simple-html-reporter</a>. See <a href="#nycrc">.nycrc</a></p>
</li>
<li>
<p><strong>build:typedoc</strong> : build typescript documentation with <a href="https://github.com/TypeStrong/typedoc" target="_blank">typedoc</a></p>
</li>
<li>
<p><strong>build:asciidoc</strong> : build this documentation with <a href="https://github.com/asciidoctor" target="_blank">asciidoctor</a>. See <a href="#index.adoc">index.adoc</a></p>
</li>
<li>
<p><strong>build:doc</strong> : alias for build:doc:*</p>
</li>
<li>
<p><strong>build:prepare</strong> : alias for clean, lint, test:report, build:doc</p>
</li>
<li>
<p><strong>build:bundle</strong> : create bundle with <a href="https://github.com/webpack/webpack" target="_blank">webpack</a>. See <a href="#webpack.config.js">webpack.config.js</a> &amp; <a href="#tsconfig.json">tsconfig.json</a></p>
</li>
<li>
<p><strong>build</strong> : alias for build:prepare &amp; build:bundle</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#package.json">package.json</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_files">Files</h4>
<div class="sect4">
<h5 id="package.json">package.json</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;injects&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;1.0.0&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Dependency Injection for Typescript&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;author&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;mickgrz&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;main&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./build/injects.js&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;typings&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./build/injects.d.ts&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scripts&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;clean&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;rimraf build/* &amp;&amp; rimraf docs/* &amp;&amp; mkdir -p docs/test&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;lint&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;tslint injects.ts injects.spec.ts&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;test&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./node_modules/.bin/mocha --reporter spec --compilers ts:ts-node/register injects.spec.ts&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;test:report&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./node_modules/.bin/nyc ./node_modules/.bin/mocha --reporter mocha-simple-html-reporter --reporter-options output=docs/test/index.html --compilers ts:ts-node/register --require source-map-support/register --full-trace --bail injects.spec.ts&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build:typedoc&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./node_modules/.bin/typedoc --theme minimal --readme none --name &#39;injects&#39; --out docs/typedoc --mode file --exclude injects.spec.ts&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build:asciidoc&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asciidoctor -a linkcss -r asciidoctor-diagram documentation -o docs/index.html&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build:doc&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;npm run build:typedoc &amp;&amp; npm run build:asciidoc&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build:prepare&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;npm run clean &amp;&amp; npm run lint &amp;&amp; npm run test:report &amp;&amp; npm run build:doc&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build:bundle&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./node_modules/.bin/webpack --debug&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;build&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;npm run build:prepare &amp;&amp; npm run build:bundle&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;publish&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;npm run build &amp;&amp; npm publish&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;devDependencies&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;@types/chai&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^3.4.35&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;@types/mocha&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.2.39&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;chai&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^3.5.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;mocha&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^3.2.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;mocha-simple-html-reporter&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^1.0.1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;nyc&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^10.1.2-candidate.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;rimraf&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.6.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;source-map-loader&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.2.1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;source-map-support&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.4.11&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;ts-loader&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.0.1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;ts-node&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.1.0&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;tslint&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^4.4.2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;tslint-loader&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^3.4.3&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;typedoc&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^0.5.7&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;typescript&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.2.1&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;webpack&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;^2.2.1&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;repository&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;git&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;git+https://github.com/mickgrz/injects.git&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;bugs&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;https://github.com/mickgrz/injects/issues&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;homepage&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;https://github.com/mickgrz/injects#readme&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;keywords&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-s2">&quot;injects&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;dependency&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;injection&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;ioc&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;clean&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;code&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;cleancode&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;typescript&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;tslint&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;mocha&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;chai&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;nyc&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;typedoc&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;webpack&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;asciidoctor&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;asciidoctor-diagram&quot;</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="injects.ts">injects.ts</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</div></td><td class="code"><span></span><span class="tok-c1">// tag::import[]</span>
<span class="tok-kr">import</span> <span class="tok-o">*</span> <span class="tok-kr">as</span> <span class="tok-nx">assert</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;assert&#39;</span><span class="tok-p">;</span>
<span class="tok-c1">// end::import[]</span>

<span class="tok-c1">// tag::injectables[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * All injectables.</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">let</span> <span class="tok-nx">injectables</span><span class="tok-o">:</span> <span class="tok-p">{</span> <span class="tok-p">[</span><span class="tok-nx">k</span>: <span class="tok-kt">string</span><span class="tok-p">]</span><span class="tok-o">:</span> <span class="tok-nx">any</span><span class="tok-p">;</span> <span class="tok-p">}</span> <span class="tok-o">=</span> <span class="tok-p">{};</span>
<span class="tok-c1">// end::injectables[]</span>


<span class="tok-c1">// tag::Injectable[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * Register an injectable.</span>
<span class="tok-cm"> * Can be used as a class decorator or as a function.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param constructorOrKey class constructor or custom string key</span>
<span class="tok-cm"> * @param instance custom instance to register (optional with class constructor, mandatory with string key)</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">constructorOrKey</span>: <span class="tok-kt">Function</span> <span class="tok-o">|</span> <span class="tok-kt">string</span><span class="tok-p">,</span> <span class="tok-nx">instance?</span>: <span class="tok-kt">any</span><span class="tok-p">)</span><span class="tok-o">:</span> <span class="tok-k">void</span> <span class="tok-p">{</span>
  <span class="tok-kd">let</span> <span class="tok-nx">key</span>: <span class="tok-kt">string</span><span class="tok-p">,</span> <span class="tok-nx">injectable</span>: <span class="tok-kt">any</span><span class="tok-p">;</span>
  <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">constructorOrKey</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">assert</span><span class="tok-p">.</span><span class="tok-nx">equal</span><span class="tok-p">(</span><span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-o">!!</span><span class="tok-p">(</span><span class="tok-nx">instance</span><span class="tok-p">),</span> <span class="tok-s1">&#39;can\&#39;t define injectable without instance&#39;</span><span class="tok-p">);</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">injectable</span> <span class="tok-o">=</span> <span class="tok-nx">instance</span>
  <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span>
    <span class="tok-kr">const</span> <span class="tok-kr">constructor</span><span class="tok-o">:</span> <span class="tok-nb">Function</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">name</span><span class="tok-p">;</span>
    <span class="tok-nx">injectable</span> <span class="tok-o">=</span> <span class="tok-nx">instance</span> <span class="tok-o">?</span> <span class="tok-nx">instance</span> : <span class="tok-kt">new</span> <span class="tok-p">(</span><span class="tok-nb">Object</span><span class="tok-p">.</span><span class="tok-nx">create</span><span class="tok-p">(</span><span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">prototype</span><span class="tok-p">)).</span><span class="tok-kr">constructor</span><span class="tok-p">();</span>
  <span class="tok-p">}</span>
  <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">key</span><span class="tok-p">]</span> <span class="tok-o">=</span> <span class="tok-nx">injectable</span><span class="tok-p">;</span>
<span class="tok-p">}</span>
<span class="tok-c1">// end::Injectable[]</span>

<span class="tok-c1">// tag::inject[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * Inject unique instance associated with class name or with custom string key.</span>
<span class="tok-cm"> * Create unique class instance if it doesn&#39;t exist.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param constructorOrKey class constructor or custom string key</span>
<span class="tok-cm"> * @return the unique instance associated with class name or with custom string key</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">constructorOrKey</span>: <span class="tok-kt">Function</span> <span class="tok-o">|</span> <span class="tok-kt">string</span><span class="tok-p">)</span><span class="tok-o">:</span> <span class="tok-nx">any</span> <span class="tok-p">{</span>
  <span class="tok-kd">let</span> <span class="tok-nx">key</span>: <span class="tok-kt">string</span><span class="tok-p">;</span>
  <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-k">typeof</span> <span class="tok-nx">constructorOrKey</span> <span class="tok-o">===</span> <span class="tok-s1">&#39;string&#39;</span><span class="tok-p">)</span> <span class="tok-p">{</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span> 
  <span class="tok-p">}</span> <span class="tok-k">else</span> <span class="tok-p">{</span><i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-kr">const</span> <span class="tok-kr">constructor</span><span class="tok-o">:</span> <span class="tok-nb">Function</span> <span class="tok-o">=</span> <span class="tok-nx">constructorOrKey</span><span class="tok-p">;</span>
    <span class="tok-nx">key</span> <span class="tok-o">=</span> <span class="tok-kr">constructor</span><span class="tok-p">.</span><span class="tok-nx">name</span><span class="tok-p">;</span> 
    <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-o">!</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-nx">key</span><span class="tok-p">))</span> <span class="tok-p">{</span><i class="conum" data-value="2"></i><b>(2)</b>
      <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-kr">constructor</span><span class="tok-p">);</span> 
    <span class="tok-p">}</span><i class="conum" data-value="3"></i><b>(3)</b>
  <span class="tok-p">}</span>
  <span class="tok-k">return</span> <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">key</span><span class="tok-p">];</span> 
<span class="tok-p">}</span><i class="conum" data-value="4"></i><b>(4)</b>
<span class="tok-c1">// end::inject[]</span>

<span class="tok-c1">// tag::exists[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * In order to know if a dependency exists or not.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @param name dependency name</span>
<span class="tok-cm"> * @returns true if dependency exist, false otherwise</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-nx">name</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-k">return</span> <span class="tok-nb">Object</span><span class="tok-p">.</span><span class="tok-nx">keys</span><span class="tok-p">(</span><span class="tok-nx">injectables</span><span class="tok-p">).</span><span class="tok-nx">some</span><span class="tok-p">(</span><span class="tok-nx">k</span> <span class="tok-o">=&gt;</span> <span class="tok-nx">k</span> <span class="tok-o">===</span> <span class="tok-nx">name</span><span class="tok-p">);</span>
<span class="tok-p">}</span>
<span class="tok-c1">// end::exists[]</span>

<span class="tok-c1">// Only for tests</span>

<span class="tok-c1">// tag::resetInjectables[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * Only for tests : delete all injectables</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">resetInjectables() {</span>
  <span class="tok-nx">injectables</span> <span class="tok-o">=</span> <span class="tok-p">{};</span>
<span class="tok-p">}</span>
<span class="tok-c1">// end::resetInjectables[]</span>

<span class="tok-c1">// tag::resetInjectable[]</span>
<span class="tok-cm">/**</span>
<span class="tok-cm"> * Only for tests : delete an injectable</span>
<span class="tok-cm"> */</span>
<span class="tok-kr">export</span> <span class="tok-kd">function</span> <span class="tok-nx">resetInjectable</span><span class="tok-p">(</span><span class="tok-nx">name</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{</span>
  <span class="tok-k">delete</span> <span class="tok-nx">injectables</span><span class="tok-p">[</span><span class="tok-nx">name</span><span class="tok-p">];</span>
<span class="tok-p">}</span>
<span class="tok-c1">// end::resetInjectable[]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tslint.json">tslint.json</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;rules&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;indent&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span><span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-s2">&quot;spaces&quot;</span><span class="tok-p">],</span>
    <span class="tok-nt">&quot;no-trailing-whitespace&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;quotemark&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span><span class="tok-kc">true</span><span class="tok-p">,</span> <span class="tok-s2">&quot;single&quot;</span><span class="tok-p">]</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="injects.spec.ts">injects.spec.ts</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="ts"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213</div></td><td class="code"><span></span><span class="tok-kr">import</span> <span class="tok-p">{</span><span class="tok-nx">expect</span><span class="tok-p">}</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;chai&#39;</span><span class="tok-p">;</span>
<span class="tok-kr">import</span> <span class="tok-p">{</span><span class="tok-nx">exists</span><span class="tok-p">,</span> <span class="tok-nx">inject</span><span class="tok-p">,</span> <span class="tok-nx">Injectable</span><span class="tok-p">,</span> <span class="tok-nx">resetInjectables</span><span class="tok-p">,</span> <span class="tok-nx">resetInjectable</span><span class="tok-p">}</span> <span class="tok-nx">from</span> <span class="tok-s1">&#39;./injects&#39;</span><span class="tok-p">;</span>


<span class="tok-kr">const</span> <span class="tok-nx">assume</span> <span class="tok-o">=</span> <span class="tok-nx">expect</span><span class="tok-p">;</span>

<span class="tok-nx">describe</span><span class="tok-p">(</span><span class="tok-s1">&#39;Dependency Injection&#39;</span><span class="tok-p">,</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>

  <span class="tok-nx">afterEach</span><span class="tok-p">(</span><span class="tok-nx">resetInjectables</span><span class="tok-p">);</span>

  <span class="tok-c1">// tag::shouldRegisterDependency[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should register dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldRegisterDependency[]</span>

  <span class="tok-c1">// tag::shouldInjectDependency[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectDependency[]</span>

  <span class="tok-c1">// tag::shouldInjectClassDependency[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject class dependency&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">not</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">null</span><span class="tok-p">;</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectClassDependency[]</span>

  <span class="tok-c1">// tag::shouldInjectCustomObjectInstance[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject custom object instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{</span> <span class="tok-kr">constructor</span><span class="tok-p">(</span><span class="tok-kr">public</span> <span class="tok-nx">value</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{}</span> <span class="tok-p">}</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSampleValue&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-k">new</span> <span class="tok-nx">Sample</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">));</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>:<span class="tok-kt">Sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">.</span><span class="tok-nx">value</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectCustomObjectInstance[]</span>

  <span class="tok-c1">// tag::shouldInjectCustomClassInstance[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject custom class instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{</span> <span class="tok-kr">constructor</span><span class="tok-p">(</span><span class="tok-kr">public</span> <span class="tok-nx">value</span>: <span class="tok-kt">string</span><span class="tok-p">)</span> <span class="tok-p">{}</span> <span class="tok-p">}</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSampleValue&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">,</span> <span class="tok-k">new</span> <span class="tok-nx">Sample</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">));</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>:<span class="tok-kt">Sample</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">.</span><span class="tok-nx">value</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectCustomClassInstance[]</span>

  <span class="tok-c1">// tag::shouldThrowAssertExceptionWhenCreatingInjectableWithCustomStringKeyButWithoutInstance[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should throw assert exception when creating Injectable with custom string key but without instance&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-kd">let</span> <span class="tok-nx">assertionError</span> <span class="tok-o">=</span> <span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-k">try</span> <span class="tok-p">{</span>
      <span class="tok-c1">// When</span>
      <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>
    <span class="tok-p">}</span> <span class="tok-k">catch</span> <span class="tok-p">(</span><span class="tok-nx">e</span><span class="tok-p">)</span> <span class="tok-p">{</span>
      <span class="tok-nx">assertionError</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">assertionError</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldThrowAssertExceptionWhenCreatingInjectableWithCustomStringKeyButWithoutInstance[]</span>

  <span class="tok-c1">// tag::shouldInjectString[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject string&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span>: <span class="tok-kt">string</span> <span class="tok-o">=</span> <span class="tok-s1">&#39;testSample&#39;</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>: <span class="tok-kt">string</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">a</span><span class="tok-p">(</span><span class="tok-s1">&#39;string&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectString[]</span>

  <span class="tok-c1">// tag::shouldInjectNumber[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject number&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sampleValue</span>: <span class="tok-kt">number</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-p">;</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">,</span> <span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">sample</span>: <span class="tok-kt">number</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-s1">&#39;sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">eql</span><span class="tok-p">(</span><span class="tok-nx">sampleValue</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">sample</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">a</span><span class="tok-p">(</span><span class="tok-s1">&#39;number&#39;</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectNumber[]</span>

  <span class="tok-c1">// tag::shouldRegister@Injectable[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should register @Injectable&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldRegister@Injectable[]</span>

  <span class="tok-c1">// tag::shouldInjectInCascade[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should inject in cascade&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">One</span> <span class="tok-p">{}</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Two</span> <span class="tok-p">{</span> <span class="tok-kr">public</span> <span class="tok-nx">one</span>: <span class="tok-kt">One</span><span class="tok-p">;</span> <span class="tok-kr">constructor</span><span class="tok-p">()</span> <span class="tok-p">{</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">one</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">One</span><span class="tok-p">);</span> <span class="tok-p">}</span> <span class="tok-p">}</span>
    <span class="tok-kd">@Injectable</span> <span class="tok-kr">class</span> <span class="tok-nx">Three</span> <span class="tok-p">{</span> <span class="tok-kr">public</span> <span class="tok-nx">two</span>: <span class="tok-kt">Two</span><span class="tok-p">;</span> <span class="tok-kr">constructor</span><span class="tok-p">()</span> <span class="tok-p">{</span> <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">two</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Two</span><span class="tok-p">);</span> <span class="tok-p">}</span> <span class="tok-p">}</span>

    <span class="tok-c1">// When</span>
    <span class="tok-kr">const</span> <span class="tok-nx">three</span> <span class="tok-o">=</span> <span class="tok-nx">inject</span><span class="tok-p">(</span><span class="tok-nx">Three</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Three</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">.</span><span class="tok-nx">two</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">Two</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">three</span><span class="tok-p">.</span><span class="tok-nx">two</span><span class="tok-p">.</span><span class="tok-nx">one</span><span class="tok-p">).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-nx">an</span><span class="tok-p">.</span><span class="tok-nx">instanceOf</span><span class="tok-p">(</span><span class="tok-nx">One</span><span class="tok-p">);</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldInjectInCascade[]</span>

  <span class="tok-c1">// tag::shouldResetInjectables[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should reset injectables&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample2</span> <span class="tok-p">{}</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample2</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">resetInjectables</span><span class="tok-p">();</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldResetInjectables[]</span>

  <span class="tok-c1">// tag::shouldResetInjectable[]</span>
  <span class="tok-nx">it</span><span class="tok-p">(</span><span class="tok-s1">&#39;should reset injectable&#39;</span><span class="tok-p">,</span> <span class="tok-nx">async</span> <span class="tok-p">()</span> <span class="tok-o">=&gt;</span> <span class="tok-p">{</span>
    <span class="tok-c1">// Given</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">assume</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample</span> <span class="tok-p">{}</span>
    <span class="tok-kr">class</span> <span class="tok-nx">Sample2</span> <span class="tok-p">{}</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample</span><span class="tok-p">);</span>
    <span class="tok-nx">Injectable</span><span class="tok-p">(</span><span class="tok-nx">Sample2</span><span class="tok-p">);</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>

    <span class="tok-c1">// When</span>
    <span class="tok-nx">resetInjectable</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">);</span>

    <span class="tok-c1">// Then</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">false</span><span class="tok-p">;</span>
    <span class="tok-nx">expect</span><span class="tok-p">(</span><span class="tok-nx">exists</span><span class="tok-p">(</span><span class="tok-s1">&#39;Sample2&#39;</span><span class="tok-p">)).</span><span class="tok-nx">to</span><span class="tok-p">.</span><span class="tok-nx">be</span><span class="tok-p">.</span><span class="tok-kc">true</span><span class="tok-p">;</span>
  <span class="tok-p">});</span>
  <span class="tok-c1">// end::shouldResetInjectable[]</span>

<span class="tok-p">});</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="nycrc">.nycrc</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;include&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;injects.ts&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;extension&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;.ts&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;require&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;ts-node/register&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;reporter&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-s2">&quot;json&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;text-summary&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;html&quot;</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;sourceMap&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;instrument&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;report-dir&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./docs/test/coverage&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;all&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="webpack.config.js">webpack.config.js</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="js"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</div></td><td class="code"><span></span><span class="tok-s1">&#39;use strict&#39;</span><span class="tok-p">;</span>


<span class="tok-nx">module</span><span class="tok-p">.</span><span class="tok-nx">exports</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
  <span class="tok-nx">entry</span><span class="tok-o">:</span> <span class="tok-s1">&#39;./injects.ts&#39;</span><span class="tok-p">,</span>
  <span class="tok-nx">target</span><span class="tok-o">:</span> <span class="tok-s1">&#39;node&#39;</span><span class="tok-p">,</span>
  <span class="tok-nx">output</span><span class="tok-o">:</span> <span class="tok-p">{</span>
    <span class="tok-nx">path</span><span class="tok-o">:</span> <span class="tok-nx">__dirname</span><span class="tok-p">,</span>
    <span class="tok-nx">filename</span><span class="tok-o">:</span> <span class="tok-sb">`build/injects.js`</span><span class="tok-p">,</span>
    <span class="tok-nx">libraryTarget</span><span class="tok-o">:</span> <span class="tok-s1">&#39;commonjs&#39;</span>
  <span class="tok-p">},</span>
  <span class="tok-nx">resolve</span><span class="tok-o">:</span> <span class="tok-p">{</span>
    <span class="tok-nx">extensions</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s1">&#39;.js&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;.ts&#39;</span><span class="tok-p">]</span>
  <span class="tok-p">},</span>
  <span class="tok-nx">devtool</span><span class="tok-o">:</span> <span class="tok-s1">&#39;source-map&#39;</span><span class="tok-p">,</span>
  <span class="tok-nx">module</span><span class="tok-o">:</span> <span class="tok-p">{</span>
    <span class="tok-nx">loaders</span><span class="tok-o">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span>
        <span class="tok-nx">test</span><span class="tok-o">:</span> <span class="tok-sr">/\.ts$/</span><span class="tok-p">,</span>
        <span class="tok-nx">enforce</span><span class="tok-o">:</span> <span class="tok-s1">&#39;pre&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">loader</span><span class="tok-o">:</span> <span class="tok-s1">&#39;tslint-loader&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">options</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-nx">emitErrors</span><span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
          <span class="tok-nx">failOnHint</span><span class="tok-o">:</span> <span class="tok-kc">true</span>
        <span class="tok-p">}</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
        <span class="tok-nx">test</span><span class="tok-o">:</span> <span class="tok-sr">/\.ts$/</span><span class="tok-p">,</span>
        <span class="tok-nx">enforce</span><span class="tok-o">:</span> <span class="tok-s1">&#39;pre&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">loader</span><span class="tok-o">:</span> <span class="tok-s2">&quot;source-map-loader&quot;</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
        <span class="tok-nx">test</span><span class="tok-o">:</span> <span class="tok-sr">/\.ts$/</span><span class="tok-p">,</span>
        <span class="tok-nx">loader</span><span class="tok-o">:</span> <span class="tok-s1">&#39;ts-loader&#39;</span><span class="tok-p">,</span>
        <span class="tok-nx">exclude</span><span class="tok-o">:</span> <span class="tok-sr">/node_modules/</span><span class="tok-p">,</span>
        <span class="tok-nx">query</span><span class="tok-o">:</span> <span class="tok-p">{</span>
          <span class="tok-nx">presets</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;es2015&quot;</span><span class="tok-p">]</span>
        <span class="tok-p">}</span>
      <span class="tok-p">}</span>
    <span class="tok-p">]</span>
  <span class="tok-p">}</span>
<span class="tok-p">};</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tsconfig.json">tsconfig.json</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;compilerOptions&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;lib&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;es2015&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;dom&quot;</span><span class="tok-p">],</span>
    <span class="tok-nt">&quot;target&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;es6&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;module&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;commonjs&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;noImplicitAny&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;experimentalDecorators&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;declaration&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;removeComments&quot;</span><span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;outDir&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;./build&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;files&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;injects.ts&quot;</span><span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="editorconfig">.editorconfig</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="editorconfig"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span>; indicate this is the root of the project
root = true

[*]
indent_style = space
end_of_line = lf
indent_size = 2

charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="gitignore">.gitignore</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="gitignore"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span>*.swp
node_modules
.nyc_output
npm-debug.log
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="readme.md">readme.md</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="markdown"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83</div></td><td class="code"><span></span># Injects

Dependency injection for TypeScript : https://mickgrz.github.io/injects/

## Use case :

Use a class instance without instantiate it.

The responsibility of providing dependency is delegated to an injector.

This separates the responsibilities of usages and construction.

This also improves readability, testability &amp; maintainability.

### Example :

```js
class Dao {
    public create(entity: any) {
        [...]
    }
}
```

```js
import {inject} from &#39;injects&#39;;
import Dao from &#39;./Dao&#39;;

class Service {

  private dao: Dao;

  constructor() {
    this.dao = inject(Dao);
  }

  public create(entity: any) {
    return this.dao.create(entity);
  }
}
```

```js
const service: Service = new Service();
service.create({ entityId: 1 });// will call dao.create
```

You can also write :

```js
import {inject} from &#39;injects&#39;;
import Dao from &#39;./Dao&#39;;

class Service {

  private dao: Dao = inject(Dao);

  public create(entity: any) {
    return this.dao.create(entity);
  }
}
```

### Unit test example :

Stubbing dependency is easy :

```js
import {Injectable} from &#39;injects&#39;;
import * as sinon from &#39;sinon&#39;;

Injectable(&#39;Dao&#39;, sinon.stub());
const service: Service = new Service();// will get stub dependency
service.create({ entityId: 1 });// will call the stub
```

Name of dependency&#39;s class is the key used to register the dependency instance.

## Installation :

```
npm install --save injects
```
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="index.adoc">index.adoc</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight nowrap"><code data-lang="asciidoctor"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429</div></td><td class="code"><span></span>= injects
:toc: left
:toc-title: Dependency Injection for TypeScript
:toclevels: 4
:source-highlighter: pygments
:icons: font
:build-doc-dir: docs
:linkattrs:
v1.0.0, April 3, 2017



// All links of documentation

:link-webpack: https://github.com/webpack/webpack[webpack, window=&quot;_blank&quot;]
:link-asciidoctor: https://github.com/asciidoctor[asciidoctor, window=&quot;_blank&quot;]
:link-typedoc: https://github.com/TypeStrong/typedoc[typedoc, window=&quot;_blank&quot;]
:link-mocha: https://github.com/mochajs/mocha[mocha, window=&quot;_blank&quot;]
:link-chai: https://github.com/chaijs/chai[chai, window=&quot;_blank&quot;]
:link-mocha-simple-html-reporter: https://github.com/blond/mocha-simple-html-reporter[mocha-simple-html-reporter, window=&quot;_blank&quot;]
:link-nyc: https://github.com/istanbuljs/nyc[nyc, window=&quot;_blank&quot;]
:link-rimraf: https://github.com/isaacs/rimraf[rimraf, window=&quot;_blank&quot;]
:link-tslint: https://github.com/palantir/tslint[tslint, window=&quot;_blank&quot;]



https://mickgrz.github.io/injects/

[sidebar]
.Dependency Injection for TypeScript
--
--

== Use case

Use a class instance without instantiate it.

The responsibility of providing dependency is delegated to an injector.

This separates the responsibilities of usages and construction.

This also improves readability, testability &amp; maintainability.


=== Example

[source%nowrap,ts,linenums]
.Dao.ts
----
class Dao {
    public create(entity: any) {
        [...]
    }
}
----

[cols=&quot;2&quot;]
|===
a|
[source%nowrap,ts,linenums]
.Service.ts
----
import {inject} from &#39;injects&#39;; <i class="conum" data-value="1"></i><b>(1)</b>
import Dao from &#39;./Dao&#39;;

class Service {

  private dao: Dao;

  constructor() {
    this.dao = inject(Dao); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  public create(entity: any) {
    return this.dao.create(entity);
  }
}
----
a|
[TIP]
--
&lt;1&gt; imports inject function
&lt;2&gt; inject instance of Dao class
--
|===

[source%nowrap,ts,linenums]
----
const service: Service = new Service();
service.create({ entityId: 1 });// will call dao.create
----

You can also write :

[source%nowrap,ts,linenums]
----
import {inject} from &#39;injects&#39;;
import Dao from &#39;./Dao&#39;;

class Service {

  private dao: Dao = inject(Dao);

  public create(entity: any) {
    return this.dao.create(entity);
  }
}
----

=== Unit test example

Stubbing dependency is easy :

[source%nowrap,ts,linenums]
----
import {Injectable} from &#39;injects&#39;;
import * as sinon from &#39;sinon&#39;;

Injectable(&#39;Dao&#39;, sinon.stub());
const service: Service = new Service();// will get stub dependency
service.create({ entityId: 1 });// will call the stub
----

Name of dependency&#39;s class is the key used when to register the dependency instance.

== Installation

```
npm install --save injects
```

== Technical documentation

=== Api

==== inject

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=inject]
----

[TIP]
--
&lt;1&gt; parameter is used as key
&lt;2&gt; class name is used as key
&lt;3&gt; register new injectable class instance if it doesn&#39;t exist
&lt;4&gt; return injectable indexed by key
--

==== Injectable

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=Injectable]
----

==== injectables

An in-memory registry (a map string:any) is used to

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=injectables]
----

==== exists

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=exists]
----

==== resetInjectables

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=resetInjectables]
----

==== resetInjectable

[source%nowrap,ts,linenums]
----
include::injects.ts[tags=resetInjectable]
----

See &lt;&lt;injects.ts&gt;&gt;

=== Lint

Code is lint with {link-tslint}. See &lt;&lt;tslint.json&gt;&gt;

    npm run lint

=== Packaging

Bundle is generated with {link-webpack}. See &lt;&lt;webpack.config.js&gt;&gt;

    npm run build:bundle

=== Documentation

This technical documentation is generated with {link-asciidoctor}.

    npm run build:doc:living

==== Typescript documentation is available link:typedoc/index.html[here, window=&quot;_blank&quot;]

It&#39;s generated with {link-typedoc}.

    npm run build:doc:typedoc

=== Tests

Tests run with {link-mocha}.

    npm run test

Assertions are wrote with {link-chai}, using the *expect syntax*.

See &lt;&lt;injects.spec.ts&gt;&gt;

==== Execution report is available link:test/index.html[here, window=&quot;_blank&quot;]

It&#39;s generated with {link-mocha-simple-html-reporter}.

    npm run test:report

++++
include::{build-doc-dir}/test/index.html[]
++++

==== Coverage report is available link:test/coverage/index.html[here, window=&quot;_blank&quot;]

It&#39;s generated with {link-nyc}.

    npm run test:report

See &lt;&lt;nycrc&gt;&gt; config file.

==== Unit tests

===== should register dependency

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldRegisterDependency]
----

===== should inject dependency

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectDependency]
----

===== should inject class dependency

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectClassDependency]
----

===== should inject custom object instance

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectCustomObjectInstance]
----

===== should inject custom class instance

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectCustomClassInstance]
----

===== should throw assert exception when creating injectable with custom string key but without instance

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldThrowAssertExceptionWhenCreatingInjectableWithCustomStringKeyButWithoutInstance]
----

===== should inject string

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectString]
----

===== should inject number

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectNumber]
----

===== should register @Injectable

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldRegister@Injectable]
----

===== should inject in cascade

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldInjectInCascade]
----

===== should reset injectables

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldResetInjectables]
----

===== should reset injectable

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[tags=shouldResetInjectable]
----

=== Development

==== Prerequisites

* {link-asciidoctor}

==== Npm scripts

* **clean** : remove build/ directory with {link-rimraf}
* **lint** : lint source directory with {link-tslint}. See &lt;&lt;tslint.json&gt;&gt;
* **test** : run tests with {link-mocha} &amp; {link-chai}
* **test:report** : run tests with {link-nyc} over {link-mocha} with {link-mocha-simple-html-reporter}. See &lt;&lt;nycrc&gt;&gt;
* **build:typedoc** : build typescript documentation with {link-typedoc}
* **build:asciidoc** : build this documentation with {link-asciidoctor}. See &lt;&lt;index.adoc&gt;&gt;
* **build:doc** : alias for build:doc:*
* **build:prepare** : alias for clean, lint, test:report, build:doc
* **build:bundle** : create bundle with {link-webpack}. See &lt;&lt;webpack.config.js&gt;&gt; &amp; &lt;&lt;tsconfig.json&gt;&gt;
* **build** : alias for build:prepare &amp; build:bundle

See &lt;&lt;package.json&gt;&gt;

==== Files

[[package.json]]
===== package.json

[source%nowrap,json,linenums]
----
include::package.json[]
----

[[injects.ts]]
===== injects.ts

[source%nowrap,ts,linenums]
----
include::injects.ts[]
----

[[tslint.json]]
===== tslint.json

[source%nowrap,json,linenums]
----
include::tslint.json[]
----

[[injects.spec.ts]]
===== injects.spec.ts

[source%nowrap,ts,linenums]
----
include::injects.spec.ts[]
----

[[nycrc]]
===== .nycrc

[source%nowrap,json,linenums]
----
include::.nycrc[]
----

[[webpack.config.js]]
===== webpack.config.js

[source%nowrap,js,linenums]
----
include::webpack.config.js[]
----

[[tsconfig.json]]
===== tsconfig.json

[source%nowrap,json,linenums]
----
include::tsconfig.json[]
----

[[editorconfig]]
===== .editorconfig

[source%nowrap,editorconfig,linenums]
----
include::.editorconfig[]
----

[[gitignore]]
===== .gitignore

[source%nowrap,gitignore,linenums]
----
include::.gitignore[]
----

[[readme.md]]
===== readme.md

[source%nowrap,markdown,linenums]
----
include::readme.md[]
----
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-04-03 23:09:12 CEST
</div>
</div>
</body>
</html>